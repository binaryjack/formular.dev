<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BaseInput Component Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-section { 
            background: #f5f5f5; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .class-output {
            background: white;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 200px;
            overflow-y: auto;
        }
        input {
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin: 5px 0;
            width: 300px;
        }
    </style>
</head>
<body>
    <h1>BaseInput Component Debug Test</h1>
    
    <div class="debug-section">
        <h2>Class Generation Test</h2>
        <p>This will simulate what BaseInput should generate:</p>
        <div id="class-debug"></div>
    </div>
    
    <div class="debug-section">
        <h2>Multiple Calls Test</h2>
        <p>Testing if multiple calls to genericStyle cause accumulation:</p>
        <div id="multiple-calls-debug"></div>
    </div>
    
    <div class="debug-section">
        <h2>Expected vs Actual</h2>
        <p>Input with expected classes:</p>
        <input 
            type="text" 
            placeholder="Expected normal input"
            class="btn-primary-500 btn-md text-primary-500 text-md border-primary-500"
        />
        <div class="class-output" id="expected-classes">btn-primary-500 btn-md text-primary-500 text-md border-primary-500</div>
        
        <p>If there's a bug, it might look like this:</p>
        <div class="class-output" id="bug-example">btn-primary-500 btn-md btn-primary-500 btn-md btn-primary-500 btn-md text-primary-500 text-md text-primary-500 text-md ...</div>
    </div>
    
    <script>
        // Simulate the issue
        function simulateGenericStyle(variants) {
            // Mock implementation to show what should happen
            const componentType = variants.componentTypes[0]; // 'input'
            const variant = variants.variant || 'primary';
            const size = variants.aspect?.size || 'md';
            
            return {
                backGround: [`btn-${variant}-500`, `btn-${size}`],
                text: [`text-${variant}-500`, `text-${size}`],
                borders: [`border-${variant}-500`],
                states: {
                    hover: `hover:btn-${variant}-600`,
                    focus: `focus:btn-${variant}-ring`,
                    disabled: 'disabled:opacity-50'
                }
            };
        }
        
        function simulateCx(...args) {
            return args.flat().filter(Boolean).join(' ');
        }
        
        // Test 1: Single call
        const singleCallResult = simulateGenericStyle({
            componentTypes: ['input'],
            variant: 'primary',
            aspect: { size: 'md' }
        });
        
        const singleCallClasses = simulateCx(
            singleCallResult.backGround,
            singleCallResult.text,
            singleCallResult.borders,
            ...Object.values(singleCallResult.states)
        );
        
        document.getElementById('class-debug').innerHTML = `
            <h3>Single Call Result:</h3>
            <div class="class-output">${singleCallClasses}</div>
            <p>Class count: ${singleCallClasses.split(' ').length}</p>
        `;
        
        // Test 2: Multiple calls (should be identical)
        const call1 = simulateGenericStyle({ componentTypes: ['input'] });
        const call2 = simulateGenericStyle({ componentTypes: ['input'] });
        const call3 = simulateGenericStyle({ componentTypes: ['input'] });
        
        const classes1 = simulateCx(call1.backGround, call1.text, call1.borders);
        const classes2 = simulateCx(call2.backGround, call2.text, call2.borders);
        const classes3 = simulateCx(call3.backGround, call3.text, call3.borders);
        
        document.getElementById('multiple-calls-debug').innerHTML = `
            <h3>Multiple Identical Calls:</h3>
            <div class="class-output">Call 1: ${classes1}</div>
            <div class="class-output">Call 2: ${classes2}</div>
            <div class="class-output">Call 3: ${classes3}</div>
            <p>Are they identical? ${classes1 === classes2 && classes2 === classes3 ? '‚úÖ Yes' : '‚ùå No'}</p>
        `;
        
        // Simulate the bug scenario
        function simulateBuggyGenericStyle() {
            // This would happen if there's a shared array or accumulation bug
            const sharedArray = ['btn-primary-500', 'btn-md'];
            
            // Each call adds to the shared array (BUG!)
            sharedArray.push('btn-primary-500', 'btn-md'); 
            sharedArray.push('text-primary-500', 'text-md');
            sharedArray.push('btn-primary-500', 'btn-md'); // Duplicate!
            
            return sharedArray.join(' ');
        }
        
        console.log('üêõ Bug simulation:', simulateBuggyGenericStyle());
    </script>
</body>
</html>
